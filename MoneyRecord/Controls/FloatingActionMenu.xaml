<?xml version="1.0" encoding="utf-8" ?>
<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodels="clr-namespace:MoneyRecord.ViewModels"
             x:Class="MoneyRecord.Controls.FloatingActionMenu"
             x:DataType="viewmodels:FloatingMenuViewModel">
    
    <Grid>
        <!-- Semi-transparent overlay when menu is expanded -->
        <BoxView BackgroundColor="#80000000"
                 IsVisible="{Binding IsExpanded}"
                 InputTransparent="False">
            <BoxView.GestureRecognizers>
                <TapGestureRecognizer Command="{Binding CloseMenuCommand}"/>
            </BoxView.GestureRecognizers>
        </BoxView>
        
        <!-- FAB Container - Bottom Right -->
        <Grid HorizontalOptions="End" 
              VerticalOptions="End"
              Margin="0,0,20,20">
            
            <VerticalStackLayout Spacing="12">
                
                <!-- Action Buttons (visible when expanded) -->
                <VerticalStackLayout Spacing="12" 
                                    IsVisible="{Binding IsExpanded}"
                                    HorizontalOptions="End">
                    
                    <!-- Income Button with Label -->
                    <HorizontalStackLayout Spacing="12" HorizontalOptions="End">
                        <Frame BackgroundColor="{AppThemeBinding Light=#FFFFFF, Dark=#1E1E1E}"
                               CornerRadius="8"
                               Padding="12,8"
                               HasShadow="True"
                               VerticalOptions="Center"
                               IsVisible="{Binding IsExpanded}">
                            <Label Text="Income"
                                   FontSize="14"
                                   FontAttributes="Bold"
                                   TextColor="{AppThemeBinding Light=#1976D2, Dark=#42A5F5}"/>
                        </Frame>
                        <Button Text="&#xF0415;"
                                FontFamily="MaterialDesignIcons"
                                Command="{Binding AddIncomeCommand}"
                                FontSize="24"
                                HeightRequest="56"
                                WidthRequest="56"
                                CornerRadius="28"
                                Padding="0"
                                BackgroundColor="{AppThemeBinding Light=#1976D2, Dark=#42A5F5}"
                                TextColor="White"
                                Shadow="{Shadow Brush=Black, Offset='2,4', Radius=6, Opacity=0.3}"/>
                    </HorizontalStackLayout>
                    
                    <!-- Transfer Button with Label -->
                    <HorizontalStackLayout Spacing="12" HorizontalOptions="End">
                        <Frame BackgroundColor="{AppThemeBinding Light=#FFFFFF, Dark=#1E1E1E}"
                               CornerRadius="8"
                               Padding="12,8"
                               HasShadow="True"
                               VerticalOptions="Center"
                               IsVisible="{Binding IsExpanded}">
                            <Label Text="Transfer"
                                   FontSize="14"
                                   FontAttributes="Bold"
                                   TextColor="{AppThemeBinding Light=#FF9800, Dark=#FFB74D}"/>
                        </Frame>
                        <Button Text="&#xF04E1;"
                                FontFamily="MaterialDesignIcons"
                                Command="{Binding AddTransferCommand}"
                                FontSize="24"
                                HeightRequest="56"
                                WidthRequest="56"
                                CornerRadius="28"
                                Padding="0"
                                BackgroundColor="{AppThemeBinding Light=#FF9800, Dark=#FFB74D}"
                                TextColor="White"
                                Shadow="{Shadow Brush=Black, Offset='2,4', Radius=6, Opacity=0.3}"/>
                    </HorizontalStackLayout>
                    
                    <!-- Expense Button with Label -->
                    <HorizontalStackLayout Spacing="12" HorizontalOptions="End">
                        <Frame BackgroundColor="{AppThemeBinding Light=#FFFFFF, Dark=#1E1E1E}"
                               CornerRadius="8"
                               Padding="12,8"
                               HasShadow="True"
                               VerticalOptions="Center"
                               IsVisible="{Binding IsExpanded}">
                            <Label Text="Expense"
                                   FontSize="14"
                                   FontAttributes="Bold"
                                   TextColor="{AppThemeBinding Light=#D32F2F, Dark=#EF5350}"/>
                        </Frame>
                        <Button Text="&#xF0374;"
                                FontFamily="MaterialDesignIcons"
                                Command="{Binding AddExpenseCommand}"
                                FontSize="24"
                                HeightRequest="56"
                                WidthRequest="56"
                                CornerRadius="28"
                                Padding="0"
                                BackgroundColor="{AppThemeBinding Light=#D32F2F, Dark=#EF5350}"
                                TextColor="White"
                                Shadow="{Shadow Brush=Black, Offset='2,4', Radius=6, Opacity=0.3}"/>
                    </HorizontalStackLayout>
                </VerticalStackLayout>
                
                <!-- Main FAB Button -->
                <Button x:Name="MainFabButton"
                        Text="{Binding IsExpanded, Converter={StaticResource BoolToFabIconConverter}}"
                        FontFamily="MaterialDesignIcons"
                        Command="{Binding ToggleMenuCommand}"
                        FontSize="28"
                        HeightRequest="64"
                        WidthRequest="64"
                        CornerRadius="32"
                        Padding="0"
                        HorizontalOptions="End"
                        BackgroundColor="{AppThemeBinding Light=#6200EE, Dark=#BB86FC}"
                        TextColor="White"
                        Shadow="{Shadow Brush=Black, Offset='2,4', Radius=8, Opacity=0.4}"/>
            </VerticalStackLayout>
        </Grid>
    </Grid>
</ContentView>
